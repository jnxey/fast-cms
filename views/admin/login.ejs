<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>文档中心-后台登录</title>
    <link rel="stylesheet" href="/resource/css/index.css"/>
    <script src="/resource/js/md5.min.js"></script>
    <!-- 引入 layui.css -->
    <link rel="stylesheet" href="//unpkg.com/layui@2.6.8/dist/css/layui.css"/>
    <!-- 引入 layui.js -->
    <script src="//unpkg.com/layui@2.6.8/dist/layui.js"></script>
    <script src="//unpkg.com/axios@1.1.2/dist/axios.min.js"></script>
    <%- include ('../_values/global.ejs') -%>
    <%- include ('./_styles/login.ejs') -%>
</head>
<body>
<div class="page-admin-page-login-wrap">
    <div class="login-box">
        <form class="layui-form" action="">
            <div class="title t-ac fz-28 fw-700 mb-32">
                文档系统登录
            </div>
            <div class="layui-form-item">
                <label>
                    <input type="text" name="name" required lay-verify="required" placeholder="请输入账号"
                           autocomplete="off" class="layui-input">
                </label>
            </div>
            <div class="layui-form-item">
                <label>
                    <input type="password" name="password" required lay-verify="required" placeholder="请输入密码"
                           autocomplete="off" class="layui-input">
                </label>
            </div>
            <div class="layui-form-item">
                <button class="layui-btn layui-btn-fluid layui-btn-lg" lay-submit
                        lay-filter="formDemo">
                    立即提交
                </button>
            </div>
        </form>

        <script>
          //Demo
          layui.use('form', function () {
            var form = layui.form;
            var url = '/api/admin-login/login';
            //监听提交
            form.on('submit(formDemo)', function (data) {
              var params = Object.assign({}, data.field);
              var salt = 'fc-salt';
              params.password = md5(params.password, salt);
              var loadIndex = layer.load();
              axios.post(url, params).then(function (response) {
                var result = response.data;
                if (result.code === window.RESPONSE_MAP.success.code) {
                  location.href = '/admin-home/index'
                } else {
                  layer.open({ title: '登录失败', content: result.msg });
                }
              }).catch(function (err) {
                layer.open({ title: '登录失败', content: err.toString() });
              }).finally(function () {
                layer.close(loadIndex);
              });
              return false;
            });
          });
        </script>
    </div>
</div>
</body>
</html>
